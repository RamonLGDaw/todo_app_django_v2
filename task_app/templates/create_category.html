<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create category</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="static/main.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
        .color-display {
            width: 100px;
            height: 30px;
            margin-left: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>

<body style="background: #c4ff7b !important;">
    <main class="container">
        <h1 class="text-center m-4">Create a new category</h1>
        {% if answer %}
        <p class="text-danger text-center">
            <i><b>{{answer}}</b></i> Category already exists, please choose another name.
        </p>
        {% endif %} {% if error %}
        <p class="text-danger text-center"><b>{{error}}</b></p>
        {% endif %}

        <form action="create_category" method="post" class="card border-black shadow p-3 mx-auto bg-light">
            <label for="category_name" class="ms-1">Category name</label>
            {% csrf_token %}
            <input class="form-control m-1" type="text" required name="category_name" id="category_name"
                placeholder="Type a category name..." />

            <input type="hidden" id="selectedColor" name="category_color" />
            <div>
                <button class="btn btn-light border ms-1 mt-2 mb-3" onclick="showCategoryList()">Delete Category</button>
            </div>
            <div class="d-flex p-2">
                <label for="color_select" class="mx-1">Select color:</label>
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="color_select"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        Choose a color
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="color_select">
                        <li>
                            <a class="dropdown-item bg-primary text-white"
                                onclick="setColor('primary', '#007bff')">Primary</a>
                        </li>
                        <li>
                            <a class="dropdown-item bg-secondary text-white"
                                onclick="setColor('secondary', '#6c757d')">Secondary</a>
                        </li>
                        <li>
                            <a class="dropdown-item bg-success text-white"
                                onclick="setColor('success', '#28a745')">Success</a>
                        </li>
                        <li>
                            <a class="dropdown-item bg-danger text-white"
                                onclick="setColor('danger', '#dc3545')">Danger</a>
                        </li>
                        <li>
                            <a class="dropdown-item bg-warning text-white"
                                onclick="setColor('warning', '#ffc107')">Warning</a>
                        </li>
                    </ul>
                </div>

                <div id="colorDisplay" class="color-display mt-1 border rounded-2"></div>
            </div>

            <div class="d-flex d-row justify-content-evenly align-items-center p-2 m-2">
                <button type="submit" class="btn btn-primary">Create</button>
                <a href="/" class="btn btn-light border">Cancel</a>
            </div>
        </form>

        <div id="category_list" class="card border-black shadow p-3 mx-auto bg-light mt-3 d-none">
            <h3 class="text-center">Delete a category.</h3>
            <p class="text-danger text-center">Be careful, the category and all of its tasks will be removed.</p>
            {% if len_category_list == 0 %}
            <p class="text-center">There are no categories to delete...</p>
            {% endif %}
            <ul class=''>
                {% for category in category_list %}
                <div class="m-1">
                    <li class="text-{{category.color}} fs-4">- {{category.name}}  <button class="btn btn-light border " onclick="showDeleteCategory('{{category.id}}')">‚ùå</button></li>
                </div>
                <div id="deleleCategory-{{category.id}}" class="d-none d-flex justify-content-evenly align-items-center">
                    <a href="deleteCategory/{{category.id}}" class="text-center btn btn-danger">Confirm Delete</a>
                    <button onclick="showDeleteCategory('{{category.id}}')" class="btn btn-light border">Cancel</button>
                </div>

                {% endfor %}
            </ul>
            <div class="d-flex justify-content-evenly align-items-center">
                <button class="btn btn-primary">Cancel</button>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        function setColor(colorName, colorCode) {
            document.getElementById("selectedColor").value = colorName;
            document.getElementById("colorDisplay").style.backgroundColor =
                colorCode;
        }

        function showCategoryList(){
            const category_list = document.getElementById('category_list');
            category_list.classList.toggle('d-none');
        }

        function showDeleteCategory(id){
            const categoryToDelete = document.getElementById(`deleleCategory-${id}`);
            categoryToDelete.classList.toggle('d-none')
        }
    </script>
</body>

</html>